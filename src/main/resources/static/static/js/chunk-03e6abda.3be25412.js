(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-03e6abda"],{"24d2":function(t,e,r){"use strict";r.r(e),r.d(e,"listPage",(function(){return n})),r.d(e,"list",(function(){return i})),r.d(e,"getById",(function(){return s})),r.d(e,"update",(function(){return o})),r.d(e,"add",(function(){return u})),r.d(e,"deleted",(function(){return c}));var a=r("b775");function n(t){return Object(a["a"])({url:"/api/project/listPage",method:"get",params:t})}function i(t){return Object(a["a"])({url:"/api/project/list",method:"get",params:t})}function s(t){return Object(a["a"])({url:"/api/project/getById?id="+t,method:"get"})}function o(t){return Object(a["a"])({url:"/api/project/update",method:"post",data:t})}function u(t){return Object(a["a"])({url:"/api/project/add",method:"post",data:t})}function c(t){return Object(a["a"])({url:"/api/project/delete",method:"post",headers:{"Content-Type":"application/json"},data:t})}},"4f43":function(t,e,r){},"5b39":function(t,e,r){"use strict";r.d(e,"a",(function(){return n})),r.d(e,"b",(function(){return p}));r("8dee"),r("fc02"),r("5199"),r("d31c"),r("1bc7"),r("32ea");var a={if:"if (%code) {\r\n\r\n}",null:"if (%code != null) {\r\n\r\n}",var:"let %var = %code\r\n",for:"for (const i in %code) {\r\n\r\n}",fori:"for (let i = 0; i < %code.length; i++) {\r\n\r\n}",try:"try{\r\n\t%code\r\n} catch (e) {\r\n\tlog.error('发生错误')\r\n}"};function n(t,e,r,a,n){if(t&&e&&((null==r||r<0)&&(r=e.length),0!==r)){for(var u=e.substring(0,r),p=e.substring(r),d=!1,f=0,m=r;m>=0;m--){if(" "===u[m]||";"===u[m]){f=m+1;break}if("{"===u[m]&&m>0&&"$"===u[m-1]){d=!0,f=m+1;break}if(("'"===u[m]||'"'===u[m])&&t.apiNameMap){var h=u[m-1];if(" "===h||"\n"===h||","===h||"{"===h){var b=u.substring(m+1,r),v=l(n,a);if(v&&t.apiNameMap[v]){for(var g=Object.keys(t.apiNameMap[v])||[],j=[],x=0;x<g.length;x++){var y=g[x]+"";y.startsWith(b)&&y!==b&&j.push({displayText:y,text:y.substring(b.length)})}return j}}}}var O=u.substring(f,r);if(O.startsWith("http.request('")){var I="";return""===p.trim()?I="')":")"===p.trim()&&(I="'"),s(i(t.apiNames,O.substring("http.request('".length),I),O,f)}if(O.startsWith('http.request("')){var q="";return""===p.trim()?q='")':")"===p.trim()&&(q='"'),s(i(t.apiNames,O.substring('http.request("'.length),q),O,f)}for(var F=O.endsWith("."),k=O.split("."),C=d?t.globalMap:t.varCodes,T=0;T<k.length;T++){var w=null;if((T<k.length-1||F)&&(w=C[k[T]]),!w){var _=Object.keys(C)||[];C=[];for(var R=0;R<_.length;R++){var $="",N=_[R]+"";d&&""===p.trim()&&($="}"),N.startsWith(k[T])&&N!==k[T]&&C.push({displayText:N,text:N.substring(k[T].length)+$})}return 0===T&&0===C.length&&(C=c(O,F,t.tempVar,a)),o(C,O,f)}C=w}return o(Object.keys(C),O,f)}}function i(t,e,r){if(r=r||"",null==t||0===t.length)return null;var a=[];for(var n in t){var i=t[n];t[n].startsWith(e)&&a.push({displayText:i,text:i.substring(e.length)+r})}return a}function s(t,e,r){return null==t||0===t.length?o(t,e,r):t}function o(t,e,r){t=t||[];var n=e.lastIndexOf(".");if(n<1)return t;var i=e.substring(0,n),s=e.substring(n+1),o=Object.keys(a);for(var c in o){var l=o[c];if(l.startsWith(s)){var p=a[l].replace("%code",i);p.indexOf("%var")>-1&&(p=p.replace("%var","v"+u(3))),t.push({displayText:l,text:p,replace:!0,startIndex:r})}}return t}function u(t){for(var e="",r=0;r<t;r++)e+=Math.floor(10*Math.random());return e}function c(t,e,r,a){for(var n=r,i=t.replaceAll("[",".[").split("."),s=0;s<i.length;s++){var o=null;if(s<i.length-1||e){var u=i[s].trim();if(Array.isArray(n)){if(!u.startsWith("[")||!u.endsWith("]")){if(""===u){var c=[];for(var l in n){if(l>10)break;var p=e?Object.assign({},a,{ch:a.ch-1}):null,d=e?Object.assign({},a,{ch:a.ch}):null;c.push({displayText:"["+l+"]",text:"["+l+"]",from:p,to:d})}return c}return[]}o=n[parseInt(u.substring(1,u.length-1))]}else o=n[u]}if(!o){if("string"===typeof n)return[];var f=Object.keys(n)||[];n=[];for(var m=0;m<f.length;m++){var h=f[m]+"";h.startsWith(i[s])&&h!==i[s]&&n.push({displayText:h,text:h.substring(i[s].length)})}return n}n=o}return n}function l(t,e){for(var r=t.split("\n"),a=-1,n=e.line;n>=0;n--)if(a=r[n].lastIndexOf("http.request("),-1!==a){if(n===e.line&&r[n].substring(0,e.ch).indexOf(")")>0)return;if(n<e.line&&r[n].substring(a).indexOf(")")>0)return;t=r[n];break}if(!(a<0)){var i=t.substring(a+"http.request(".length).trim();if(("'"===i[0]||'"'===i[0])&&(i=d(i,i[0]),i&&i.trim()))return i.trim()}}function p(t){var e=-1,r=0,a={},n="http.request(";while((e=t.indexOf(n,e+1))>-1){var i=t.substring(r,e).trim();if(i.endsWith("=")){i=i.substring(0,i.length-1).trim(),i=f(i);var s=t.substring(e+n.length).trim();"'"!==s[0]&&'"'!==s[0]||(s=d(s,s[0]),s&&s.trim()&&(a[i]=s.trim(),r=e+n.length))}}return a}function d(t,e,r){null==r&&(r=0);var a=t.indexOf(e,r);if(a<0)return null;var n=t.indexOf(e,a+1);return n<0?null:(t=t.substring(a+1,n),t.indexOf("\n")>0?null:t)}function f(t,e){var r=-1;null==e&&(e=t.length-1);for(var a=e;a>=0;a--)if(" "===t[a]||"\n"===t[a]){r=a+1;break}return r>0?t.substring(r,e+1).trim():t.substring(0,e+1).trim()}},7309:function(t,e,r){"use strict";r.d(e,"d",(function(){return n})),r.d(e,"e",(function(){return i})),r.d(e,"a",(function(){return s})),r.d(e,"c",(function(){return o})),r.d(e,"b",(function(){return u}));var a=r("b775");function n(t){return Object(a["a"])({url:"/api/script/runScript",method:"post",data:t})}function i(t){return Object(a["a"])({url:"/api/script/toScript",method:"get",params:t})}function s(t){return Object(a["a"])({url:"/api/script/apiNameTips",method:"get",params:t})}function o(){return Object(a["a"])({url:"/api/script/codeTips",method:"get"})}function u(t,e){return Object(a["a"])({url:"/api/script/apiResponseTips/"+(t||""),method:"post",data:e})}},"872f":function(t,e,r){"use strict";r.r(e);var a=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"app-container"},[r("div",{staticClass:"form-container"},[r("el-form",{ref:"dataForm",attrs:{rules:t.rules,model:t.dataForm,"label-position":"left","label-width":"120px"}},[r("el-form-item",{attrs:{label:"所属项目",prop:"projectId"}},[r("el-select",{staticClass:"filter-item",attrs:{clearable:"",filterable:"",placeholder:"请选择"},on:{change:t.loadApiList},model:{value:t.dataForm.projectId,callback:function(e){t.$set(t.dataForm,"projectId",e)},expression:"dataForm.projectId"}},t._l(t.projectList,(function(t){return r("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})})),1)],1),t._v(" "),r("el-form-item",{attrs:{label:"用例名称",prop:"caseName"}},[r("el-input",{staticStyle:{width:"400px"},attrs:{placeholder:"用例名称"},model:{value:t.dataForm.caseName,callback:function(e){t.$set(t.dataForm,"caseName",e)},expression:"dataForm.caseName"}})],1),t._v(" "),r("el-form-item",{attrs:{label:"用例描述",prop:"caseDesc"}},[r("el-input",{staticStyle:{width:"400px"},attrs:{placeholder:"用例描述"},model:{value:t.dataForm.caseDesc,callback:function(e){t.$set(t.dataForm,"caseDesc",e)},expression:"dataForm.caseDesc"}})],1),t._v(" "),r("el-form-item",{attrs:{label:"模块",prop:"module"}},[r("el-input",{staticStyle:{width:"400px"},attrs:{placeholder:"模块"},model:{value:t.dataForm.module,callback:function(e){t.$set(t.dataForm,"module",e)},expression:"dataForm.module"}})],1),t._v(" "),r("el-form-item",{attrs:{label:"作者",prop:"author"}},[r("el-input",{staticStyle:{width:"400px"},attrs:{placeholder:"作者"},model:{value:t.dataForm.author,callback:function(e){t.$set(t.dataForm,"author",e)},expression:"dataForm.author"}})],1)],1),t._v(" "),r("div",{staticStyle:{"margin-top":"10px","margin-bottom":"10px"}},[r("span",{staticClass:"script-title-span"},[t._v("用例脚本")]),t._v(" "),r("i",{staticClass:"el-icon-question",staticStyle:{cursor:"pointer"},attrs:{title:"查看示例"},on:{click:t.showExample}}),t._v(" "),r("span",{staticStyle:{"margin-left":"15px"},attrs:{title:"调试脚本"}},[r("svg-icon",{staticClass:"run-but",attrs:{"icon-class":"run"},nativeOn:{click:function(e){return t.runScript(e)}}})],1),t._v(" "),r("span",{staticStyle:{"margin-left":"200px","font-size":"10px"}},[t._v("选择插入API请求：")]),t._v(" "),r("el-select",{ref:"apiSelect",staticClass:"filter-item",attrs:{clearable:"",filterable:"",placeholder:"请选择"},on:{change:t.insertRequst},model:{value:t.apiRequestId,callback:function(e){t.apiRequestId=e},expression:"apiRequestId"}},t._l(t.apiList,(function(e){return r("el-option",{key:e.id,attrs:{label:e.apiDesc,value:e.id}},[r("span",{staticStyle:{float:"left"}},[t._v(t._s(e.apiDesc))]),t._v(" "),r("span",{staticStyle:{float:"right",color:"#8492a6","font-size":"13px"}},[t._v(t._s(e.apiName))])])})),1)],1),t._v(" "),r("javascript-editor",{ref:"scriptEditor",model:{value:t.dataForm.script,callback:function(e){t.$set(t.dataForm,"script",e)},expression:"dataForm.script"}})],1),t._v(" "),r("div",{staticStyle:{"text-align":"center","margin-top":"10px","margin-bottom":"10px"}},[t.id?r("el-button",{attrs:{type:"primary"},on:{click:t.update}},[t._v("保存")]):r("el-button",{attrs:{type:"primary"},on:{click:t.saveOrUpdate}},[t._v("新增")])],1),t._v(" "),r("example",{ref:"example"}),t._v(" "),r("script-execute",{ref:"scriptExecute"})],1)},n=[],i=(r("e186"),r("e9ff")),s=r("24d2"),o=r("ceb9"),u=r("b36c"),c=r("7309"),l=r("f6c2"),p=r("45d1"),d=r("2e50"),f={name:"TestCaseConfig",components:{JavascriptEditor:l["a"],ScriptExecute:p["a"],Example:d["a"]},data:function(){return{id:null,apiList:[],apiRequestId:null,dataForm:{projectId:null,caseName:null,caseDesc:null,module:null,author:null,script:""},projectList:[],rules:{projectId:[{required:!0,message:"请选择项目",trigger:"change"}],caseName:[{required:!0,message:"用例名称不能为空",trigger:"blur"}],caseDesc:[{required:!0,message:"用例描述不能为空",trigger:"blur"}]}}},mounted:function(){this.init()},methods:{init:function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(){var e,r,a=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(this.id=this.id||this.$route.params.id||this.$route.query.id,0!==this.id&&"0"!==this.id||(this.id=null),!this.id){t.next=9;break}return t.next=5,u["getById"](this.id);case 5:e=t.sent,r=e.data,this.dataForm=r||{},this.loadApiList();case 9:Object(s["list"])({isAvailable:1}).then((function(t){a.projectList=t.data||[]}));case 10:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),loadApiList:function(){var t=this;o["f"]({isAvailable:1,projectId:this.dataForm.projectId}).then((function(e){t.apiList=e.data||[]})),this.$refs.scriptEditor&&this.$refs.scriptEditor.reloadTips(this.dataForm.projectId)},update:function(){var t=this;this.$refs["dataForm"].validate((function(e){e&&t.$confirm("确定更新项目配置吗？").then((function(){t.saveOrUpdate()}))}))},saveOrUpdate:function(){var t=this;this.dataForm.script||""===this.dataForm.script?this.$refs["dataForm"].validate((function(e){e&&u[t.id?"update":"add"](t.dataForm).then((function(e){t.$notify({title:"Success",message:t.id?"保存成功":"新增成功",type:"success",duration:2e3}),t.id||(t.id=e.data),t.init()}))})):this.$message.error("脚本不能为空")},insertRequst:function(){var t=this;Object(c["e"])({id:this.apiRequestId}).then((function(e){t.dataForm.script=(t.dataForm.script||"")+"\r\n"+(e.data||""),t.apiRequestId=null})).catch((function(){t.apiRequestId=null}))},runScript:function(){var t=this;this.$refs["dataForm"].validate((function(e){e&&t.$refs.scriptExecute.show(t.dataForm.projectId,t.dataForm.script||"")}))},showExample:function(){var t="// 编写测试用例脚本能串联其他接口进行测试\n// 这里介绍几种请求方式\n\n// 根据请求接口的api命名请求（新增API接口时的唯一api命名）\nhttp.request('api命名')\n\n// 如果请求接口的api有${xxx}参数则通过以下方式传参\nhttp.request('api命名', { xxx: '测试' })\n\n// 请求别的接口通用方式\n// http.request(url, method, body, headers)\n// 示例\nhttp.request('${baseUrl}/api/auth/login', 'post', { username: 'admin', password: '123456' }, { 'Content-Type': 'application/json' })\n\n// 除此之外还有等以下一系列请求方法\n// http.get(url)\n// http.post(url, body, headers)\n// http.postJson(url, body)\n// http.postFormData(url, body)\n\n// 测试示例\n// 正常情况下要通过api命名请求，我这示例直接通过http请求\nlet resp = http.post('${baseUrl}/api/project/add', \n                     { name: '测试项目' + common.randCode(4), description: '描述' }, \n                     { 'Content-Type': 'application/json' });\nassertions.assertNotNull(resp);\nlet projectId = resp.data;\nassertions.assertNotNull(projectId, '项目ID');\n\nresp = http.get('${baseUrl}/api/project/getById?id=' + projectId);\nassertions.assertNotNull(resp.data);\nassertions.assertEquals(resp.data.id, projectId);\n";this.$refs.example.show("测试用例脚本示例","js",t)}}},m=f,h=(r("fbc2"),r("cba8")),b=Object(h["a"])(m,a,n,!1,null,"7c45730e",null);e["default"]=b.exports},b36c:function(t,e,r){"use strict";r.r(e),r.d(e,"listPage",(function(){return n})),r.d(e,"list",(function(){return i})),r.d(e,"getById",(function(){return s})),r.d(e,"update",(function(){return o})),r.d(e,"add",(function(){return u})),r.d(e,"deleted",(function(){return c}));var a=r("b775");function n(t){return Object(a["a"])({url:"/api/apiTestCase/listPage",method:"get",params:t})}function i(t){return Object(a["a"])({url:"/api/apiTestCase/list",method:"get",params:t})}function s(t){return Object(a["a"])({url:"/api/apiTestCase/getById?id="+t,method:"get"})}function o(t){return Object(a["a"])({url:"/api/apiTestCase/update",method:"post",data:t})}function u(t){return Object(a["a"])({url:"/api/apiTestCase/add",method:"post",data:t})}function c(t){return Object(a["a"])({url:"/api/apiTestCase/delete",method:"post",headers:{"Content-Type":"application/json"},data:t})}},ceb9:function(t,e,r){"use strict";r.d(e,"g",(function(){return n})),r.d(e,"f",(function(){return i})),r.d(e,"h",(function(){return s})),r.d(e,"i",(function(){return o})),r.d(e,"a",(function(){return u})),r.d(e,"b",(function(){return c})),r.d(e,"d",(function(){return l})),r.d(e,"c",(function(){return p})),r.d(e,"e",(function(){return d}));var a=r("b775");function n(t){return Object(a["a"])({url:"/api/apiRequest/listPage",method:"get",params:t})}function i(t){return Object(a["a"])({url:"/api/apiRequest/list",method:"get",params:t})}function s(t,e){return Object(a["a"])({url:"/api/apiRequest/queryByApiName?apiName="+t+"&projectId="+(e||""),method:"get"})}function o(t){return Object(a["a"])({url:"/api/apiRequest/update",method:"post",data:t})}function u(t){return Object(a["a"])({url:"/api/apiRequest/add",method:"post",data:t})}function c(t){return Object(a["a"])({url:"/api/apiRequest/delete",method:"post",headers:{"Content-Type":"application/json"},data:t})}function l(t){a["a"].get("/api/apiRequest/export",{responseType:"blob",params:t},{responseType:"arraybuffer",headers:{"Content-Type":"application/json"}}).then((function(t){f(t,"API接口请求.xlsx")}))}function p(){a["a"].get("/api/apiRequest/downloadTemplate",{responseType:"blob"},{responseType:"arraybuffer",headers:{"Content-Type":"application/json"}}).then((function(t){f(t,"API接口导入模板.xlsx")}))}function d(t){var e=new FormData;return e.append("file",t.file),e.append("autoCase",t.autoCase),e.append("projectId",t.projectId),a["a"].post("/api/apiRequest/import",e,{headers:{"Content-Type":"multipart/form-data","Access-Control-Allow-Origin":"*"}})}function f(t,e){var r=new Blob([t]);if(window.ActiveXObject||"ActiveXObject"in window)navigator.msSaveBlob(r,e);else{var a=document.createElement("a");a.download=e,a.style.display="none",a.href=URL.createObjectURL(r),document.body.appendChild(a),a.click(),URL.revokeObjectURL(a.href),document.body.removeChild(a)}}},fbc2:function(t,e,r){"use strict";r("4f43")}}]);