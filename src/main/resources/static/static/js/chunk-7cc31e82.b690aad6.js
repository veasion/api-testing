(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7cc31e82"],{"80d2":function(t,e,a){"use strict";a("b732")},"872f":function(t,e,a){"use strict";a.r(e);var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"app-container"},[a("div",{staticClass:"form-container"},[a("el-form",{ref:"dataForm",attrs:{rules:t.rules,model:t.dataForm,"label-position":"left","label-width":"120px"}},[a("el-form-item",{attrs:{label:"所属项目",prop:"projectId"}},[a("el-select",{staticClass:"filter-item",attrs:{clearable:"",filterable:"",placeholder:"请选择"},on:{change:t.loadApiList},model:{value:t.dataForm.projectId,callback:function(e){t.$set(t.dataForm,"projectId",e)},expression:"dataForm.projectId"}},t._l(t.projectList,(function(t){return a("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})})),1)],1),t._v(" "),a("el-form-item",{attrs:{label:"用例名称",prop:"caseName"}},[a("el-input",{staticStyle:{width:"400px"},attrs:{placeholder:"用例名称"},model:{value:t.dataForm.caseName,callback:function(e){t.$set(t.dataForm,"caseName",e)},expression:"dataForm.caseName"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"用例描述",prop:"caseDesc"}},[a("el-input",{staticStyle:{width:"400px"},attrs:{placeholder:"用例描述"},model:{value:t.dataForm.caseDesc,callback:function(e){t.$set(t.dataForm,"caseDesc",e)},expression:"dataForm.caseDesc"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"模块",prop:"module"}},[a("el-input",{staticStyle:{width:"400px"},attrs:{placeholder:"模块"},model:{value:t.dataForm.module,callback:function(e){t.$set(t.dataForm,"module",e)},expression:"dataForm.module"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"作者",prop:"author"}},[a("el-input",{staticStyle:{width:"400px"},attrs:{placeholder:"作者"},model:{value:t.dataForm.author,callback:function(e){t.$set(t.dataForm,"author",e)},expression:"dataForm.author"}})],1)],1),t._v(" "),a("div",{staticStyle:{"margin-top":"10px","margin-bottom":"10px"}},[a("span",{staticClass:"script-title-span"},[t._v("用例脚本")]),t._v(" "),a("i",{staticClass:"el-icon-question",staticStyle:{cursor:"pointer"},attrs:{title:"查看示例"},on:{click:t.showExample}}),t._v(" "),a("span",{staticStyle:{"margin-left":"15px"},attrs:{title:"调试脚本"}},[a("svg-icon",{staticClass:"run-but",attrs:{"icon-class":"run"},nativeOn:{click:function(e){return t.runScript(e)}}})],1),t._v(" "),a("span",{staticStyle:{"margin-left":"200px","font-size":"10px"}},[t._v("选择插入API请求：")]),t._v(" "),a("el-select",{ref:"apiSelect",staticClass:"filter-item",attrs:{clearable:"",filterable:"",placeholder:"请选择"},on:{change:t.insertRequst},model:{value:t.apiRequestId,callback:function(e){t.apiRequestId=e},expression:"apiRequestId"}},t._l(t.apiList,(function(e){return a("el-option",{key:e.id,attrs:{label:e.apiDesc,value:e.id}},[a("span",{staticStyle:{float:"left"}},[t._v(t._s(e.apiDesc))]),t._v(" "),a("span",{staticStyle:{float:"right",color:"#8492a6","font-size":"13px"}},[t._v(t._s(e.apiName))])])})),1)],1),t._v(" "),a("javascript-editor",{ref:"scriptEditor",model:{value:t.dataForm.script,callback:function(e){t.$set(t.dataForm,"script",e)},expression:"dataForm.script"}})],1),t._v(" "),a("div",{staticStyle:{"text-align":"center","margin-top":"10px","margin-bottom":"10px"}},[t.id?a("el-button",{attrs:{type:"primary"},on:{click:t.update}},[t._v("保存")]):a("el-button",{attrs:{type:"primary"},on:{click:t.saveOrUpdate}},[t._v("新增")])],1),t._v(" "),a("example",{ref:"example"}),t._v(" "),a("script-execute",{ref:"scriptExecute"})],1)},i=[],s=(a("96cf"),a("1da1")),n=a("24d2"),o=a("ceb9"),c=a("b36c"),l=a("7309"),p=a("f6c2"),d=a("45d1"),u=a("2e50"),m={name:"TestCaseConfig",components:{JavascriptEditor:p["a"],ScriptExecute:d["a"],Example:u["a"]},data:function(){return{id:null,apiList:[],apiRequestId:null,dataForm:{projectId:null,caseName:null,caseDesc:null,module:null,author:null,script:""},projectList:[],rules:{projectId:[{required:!0,message:"请选择项目",trigger:"change"}],caseName:[{required:!0,message:"用例名称不能为空",trigger:"blur"}],caseDesc:[{required:!0,message:"用例描述不能为空",trigger:"blur"}]}}},mounted:function(){this.init()},methods:{init:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(){var e,a,r=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(this.id=this.id||this.$route.params.id||this.$route.query.id,!this.id){t.next=8;break}return t.next=4,c["getById"](this.id);case 4:e=t.sent,a=e.data,this.dataForm=a||{},this.loadApiList();case 8:Object(n["list"])({isAvailable:1}).then((function(t){r.projectList=t.data||[]}));case 9:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),loadApiList:function(){var t=this;o["c"]({isAvailable:1,projectId:this.dataForm.projectId}).then((function(e){t.apiList=e.data||[]})),this.$refs.scriptEditor&&this.$refs.scriptEditor.reloadTips(this.dataForm.projectId)},update:function(){var t=this;this.$refs["dataForm"].validate((function(e){e&&t.$confirm("确定更新项目配置吗？").then((function(){t.saveOrUpdate()}))}))},saveOrUpdate:function(){var t=this;this.dataForm.script||""===this.dataForm.script?this.$refs["dataForm"].validate((function(e){e&&c[t.id?"update":"add"](t.dataForm).then((function(e){t.$notify({title:"Success",message:t.id?"保存成功":"新增成功",type:"success",duration:2e3}),t.id||(t.id=e.data),t.init()}))})):this.$message.error("脚本不能为空")},insertRequst:function(){var t=this;Object(l["e"])({id:this.apiRequestId}).then((function(e){t.dataForm.script=(t.dataForm.script||"")+"\r\n"+(e.data||""),t.apiRequestId=null})).catch((function(){t.apiRequestId=null}))},runScript:function(){var t=this;this.$refs["dataForm"].validate((function(e){e&&t.$refs.scriptExecute.show(t.dataForm.projectId,t.dataForm.script||"")}))},showExample:function(){var t="// 编写测试用例脚本能串联其他接口进行测试\n// 这里介绍几种请求方式\n\n// 根据请求接口的api命名请求（新增API接口时的唯一api命名）\nhttp.request('api命名')\n\n// 如果请求接口的api有${xxx}参数则通过以下方式传参\nhttp.request('api命名', { xxx: '测试' })\n\n// 请求别的接口通用方式\n// http.request(url, method, body, headers)\n// 示例\nhttp.request('${baseUrl}/api/auth/login', 'post', { username: 'admin', password: '123456' }, { 'Content-Type': 'application/json' })\n\n// 除此之外还有等以下一系列请求方法\n// http.get(url)\n// http.post(url, body, headers)\n// http.postJson(url, body)\n// http.postFormData(url, body)\n\n// 测试示例\n// 正常情况下要通过api命名请求，我这示例直接通过http请求\nlet resp = http.post('${baseUrl}/api/project/add', \n                     { name: '测试项目' + common.randCode(4), description: '描述' }, \n                     { 'Content-Type': 'application/json' });\nassertions.assertNotNull(resp);\nlet projectId = resp.data;\nassertions.assertNotNull(projectId, '项目ID');\n\nresp = http.get('${baseUrl}/api/project/getById?id=' + projectId);\nassertions.assertNotNull(resp.data);\nassertions.assertEquals(resp.data.id, projectId);\n";this.$refs.example.show("测试用例脚本示例","js",t)}}},f=m,h=(a("80d2"),a("2877")),b=Object(h["a"])(f,r,i,!1,null,"1d85f9cd",null);e["default"]=b.exports},b36c:function(t,e,a){"use strict";a.r(e),a.d(e,"listPage",(function(){return i})),a.d(e,"list",(function(){return s})),a.d(e,"getById",(function(){return n})),a.d(e,"update",(function(){return o})),a.d(e,"add",(function(){return c})),a.d(e,"deleted",(function(){return l}));var r=a("b775");function i(t){return Object(r["a"])({url:"/api/apiTestCase/listPage",method:"get",params:t})}function s(t){return Object(r["a"])({url:"/api/apiTestCase/list",method:"get",params:t})}function n(t){return Object(r["a"])({url:"/api/apiTestCase/getById?id="+t,method:"get"})}function o(t){return Object(r["a"])({url:"/api/apiTestCase/update",method:"post",data:t})}function c(t){return Object(r["a"])({url:"/api/apiTestCase/add",method:"post",data:t})}function l(t){return Object(r["a"])({url:"/api/apiTestCase/delete",method:"post",headers:{"Content-Type":"application/json"},data:t})}},b732:function(t,e,a){},ceb9:function(t,e,a){"use strict";a.d(e,"d",(function(){return i})),a.d(e,"c",(function(){return s})),a.d(e,"e",(function(){return n})),a.d(e,"a",(function(){return o})),a.d(e,"b",(function(){return c}));var r=a("b775");function i(t){return Object(r["a"])({url:"/api/apiRequest/listPage",method:"get",params:t})}function s(t){return Object(r["a"])({url:"/api/apiRequest/list",method:"get",params:t})}function n(t){return Object(r["a"])({url:"/api/apiRequest/update",method:"post",data:t})}function o(t){return Object(r["a"])({url:"/api/apiRequest/add",method:"post",data:t})}function c(t){return Object(r["a"])({url:"/api/apiRequest/delete",method:"post",headers:{"Content-Type":"application/json"},data:t})}}}]);